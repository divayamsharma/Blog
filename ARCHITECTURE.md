# Blog Architecture

## How Everything Works Together

### 1. Content Pipeline

```
Obsidian Vault
    ↓
Write Posts (Markdown)
    ↓
_posts/ Folder
    ↓
Git Push to GitHub
    ↓
GitHub Actions (CI/CD)
    ↓
Jekyll Build Process
    ↓
_site/ (Static HTML)
    ↓
GitHub Pages Deployment
    ↓
Live Website
```

### 2. Build Process (Automated via GitHub Actions)

```
┌─────────────────────────────────────┐
│  You Push to GitHub                 │
└─────────────┬───────────────────────┘
              │
              ↓
┌─────────────────────────────────────┐
│  GitHub Actions Triggers            │
│  (.github/workflows/*.yml)          │
└─────────────┬───────────────────────┘
              │
              ├─→ ┌──────────────────┐
              │   │ Install Deps     │
              │   │ (Ruby + Node)    │
              │   └──────────────────┘
              │
              ├─→ ┌──────────────────┐
              │   │ Generate Graph   │
              │   │ (Node script)    │
              │   └──────────────────┘
              │
              ├─→ ┌──────────────────┐
              │   │ Build Site       │
              │   │ (Jekyll)         │
              │   └──────────────────┘
              │
              ├─→ ┌──────────────────┐
              │   │ Optimize Assets  │
              │   │ (csso, terser)   │
              │   └──────────────────┘
              │
              └─→ ┌──────────────────┐
                  │ Deploy to Pages  │
                  │ (GitHub Pages)   │
                  └──────────────────┘
```

### 3. Directory Structure & Data Flow

```
Project Root
│
├── Content Layer
│   ├── _posts/
│   │   ├── 2024-01-15-post1.md ←─── Write in Obsidian
│   │   ├── 2024-01-20-post2.md
│   │   └── 2024-02-01-post3.md
│   │
│   ├── index.md (Homepage)
│   ├── blog.md (Blog listing)
│   ├── graph.md (Knowledge graph)
│   └── about.md (About page)
│
├── Templates Layer
│   ├── _layouts/
│   │   ├── default.html ──┐
│   │   ├── home.html ────→├─ Renders markdown
│   │   └── post.html ────┘
│   │
│   └── _includes/
│       ├── header.html
│       └── footer.html
│
├── Styling Layer
│   └── assets/css/
│       └── style.scss ──→ Compiles to CSS
│
├── JavaScript Layer
│   └── assets/js/
│       ├── main.js ──────────→ Core functionality
│       ├── knowledge-graph.js → D3.js visualization
│       └── search.js ────────→ Post searching
│
├── Data Layer
│   └── assets/data/
│       └── posts-graph.json ← Auto-generated by Node script
│
└── Config Layer
    ├── _config.yml ──────────→ Jekyll config
    ├── Gemfile ───────────────→ Ruby gems
    ├── package.json ──────────→ Node packages
    └── .github/workflows/ ───→ GitHub Actions
```

### 4. Data Generation (Knowledge Graph)

```
Step 1: Read Posts
┌─────────────────────────────────────┐
│ scripts/generate-graph-data.js      │
│ reads _posts/*.md                   │
└──────────┬──────────────────────────┘
           │
           ↓
Step 2: Parse Front Matter
┌─────────────────────────────────────┐
│ Extract:                            │
│ - title                             │
│ - tags: [tag1, tag2, tag3]          │
│ - categories: [cat1]                │
└──────────┬──────────────────────────┘
           │
           ↓
Step 3: Build Graph
┌─────────────────────────────────────┐
│ Create Nodes:                       │
│ - Post nodes                        │
│ - Tag nodes                         │
│ - Category nodes                    │
│                                     │
│ Create Links:                       │
│ - Post → Tag                        │
│ - Post → Category                   │
│ - Related posts (shared tags)       │
└──────────┬──────────────────────────┘
           │
           ↓
Step 4: Output JSON
┌─────────────────────────────────────┐
│ assets/data/posts-graph.json        │
│ { nodes: [...], links: [...] }      │
└──────────┬──────────────────────────┘
           │
           ↓
Step 5: Visualize
┌─────────────────────────────────────┐
│ assets/js/knowledge-graph.js        │
│ Loads JSON with D3.js               │
│ Renders interactive graph at /graph │
└─────────────────────────────────────┘
```

### 5. Page Rendering Pipeline

```
User visits: https://yourblog.com/blog/post-title/

                    ↓

Browser requests HTML
                    ↓
GitHub Pages serves _site/blog/post-title/index.html
                    ↓
HTML contains:
├─ Meta tags (SEO)
├─ Link to CSS
├─ Content (markdown → HTML)
├─ Links to JS files
└─ Structured data (JSON-LD)
                    ↓
Browser parses HTML
                    ↓
CSS loads and renders styling
                    ↓
JS loads (deferred):
├─ main.js → Lazy loading, search
├─ knowledge-graph.js → D3.js graph
└─ Analytics → Google Analytics
                    ↓
Images load on demand (lazy loading)
                    ↓
Page interactive
```

### 6. Knowledge Graph Rendering

```
User visits: https://yourblog.com/graph/

                    ↓

browser_snapshot requests:
1. assets/data/posts-graph.json
                    ↓
JavaScript loads JSON:
{
  "nodes": [
    {id: "post-1", label: "Post Title", type: "post"},
    {id: "tag-growth", label: "growth", type: "tag"},
    ...
  ],
  "links": [
    {source: "post-1", target: "tag-growth"},
    ...
  ]
}
                    ↓
D3.js creates force simulation:
├─ Force: gravity (center)
├─ Force: repulsion (nodes spread)
├─ Force: attraction (links pull)
└─ Force: collision (prevent overlap)
                    ↓
SVG elements created:
├─ Lines for links
├─ Circles for nodes
└─ Text labels
                    ↓
Event listeners added:
├─ Drag: move nodes
├─ Hover: highlight connections
├─ Click: view related posts
└─ Zoom: scale graph
                    ↓
Fully interactive graph
```

### 7. Performance Optimization

```
Original Assets          →    Optimized Assets
─────────────────               ─────────────
style.scss (15KB)        →    style.css (8KB minified)
main.js (8KB)            →    main.js (4KB minified)
knowledge-graph.js (35KB) →   knowledge-graph.js (25KB)
image.jpg (2MB)          →    image.jpg (200KB)

                         Gzip Compression (server)
                         ↓
                         ½ size on the wire

Result:
- Faster download
- Faster rendering
- Better Google Lighthouse scores
- Better user experience
```

### 8. Search Implementation

```
User types in search box
                    ↓
JavaScript captures input event
                    ↓
Text compared against post data:
├─ Post titles (toLowerCase)
├─ Post tags (toLowerCase)
└─ Post categories
                    ↓
Matching posts shown
Non-matching posts hidden
                    ↓
Results update in real-time (as user types)
```

### 9. Deployment Architecture

```
┌─────────────────────────────────┐
│  Your Computer                  │
│  ├─ Git repo                    │
│  └─ _posts/ with Markdown       │
└────────────┬────────────────────┘
             │
             │ git push origin main
             ↓
┌─────────────────────────────────┐
│  GitHub Repository              │
│  ├─ Main branch updated         │
│  └─ Triggers webhook            │
└────────────┬────────────────────┘
             │
             ↓
┌─────────────────────────────────┐
│  GitHub Actions Runner          │
│  ├─ Ruby environment            │
│  ├─ Node environment            │
│  └─ Runs build script           │
└────────────┬────────────────────┘
             │
             ├─ npm install
             ├─ npm run graph
             ├─ jekyll build
             ├─ npm run optimize
             │
             ↓
┌─────────────────────────────────┐
│  GitHub Pages CDN               │
│  ├─ Hosts static files          │
│  ├─ Global distribution         │
│  └─ Free SSL certificate        │
└────────────┬────────────────────┘
             │
             ↓
┌─────────────────────────────────┐
│  User's Browser                 │
│  ├─ Downloads from nearest CDN  │
│  ├─ Renders page                │
│  └─ Fully interactive           │
└─────────────────────────────────┘
```

### 10. Key Integration Points

```
Obsidian Vault
     ↑
     │ (Write posts as .md files)
     │
     ├─→ _posts/ folder
            │
            ├─→ Jekyll processes
            │   ├─ Extracts front matter
            │   ├─ Converts Markdown → HTML
            │   ├─ Applies templates
            │   └─ Generates URLs
            │
            └─→ Node script processes
                ├─ Reads all posts
                ├─ Extracts tags/categories
                ├─ Creates graph nodes/links
                └─ Generates JSON

            ↓
        GitHub Actions
            ├─ Builds static site
            ├─ Minifies CSS/JS
            ├─ Optimizes images
            └─ Deploys to Pages

            ↓
        Live Website
            ├─ Homepage
            ├─ Blog posts
            ├─ Knowledge graph
            ├─ About page
            └─ Search functionality
```

## Technology Stack

```
Frontend
├─ HTML5 (semantic)
├─ SCSS → CSS (compiled)
└─ Vanilla JavaScript (no jQuery)
   ├─ D3.js v7 (visualization)
   └─ Native APIs (fetch, IntersectionObserver)

Backend/Build
├─ Jekyll 4.3+ (static generator)
├─ Ruby 3.0+ (Jekyll runtime)
└─ Node.js 16+ (build scripts)

Hosting
├─ GitHub Pages (free!)
├─ GitHub Actions (CI/CD)
└─ CDN (Fastly/Akamai behind GitHub)

Database
└─ Markdown files (no database needed!)
```

## Performance Targets

```
Metric                Target    Method
──────────────────────────────────────────────
Page Load Time        < 2s      CDN + Static
Time to Interactive   < 1.5s    Defer JS
Largest Image         < 200KB   Compression
CSS Size             < 20KB     SCSS + Minify
JS Size              < 50KB     Minification
Lighthouse Score     90+        All above
Core Web Vitals      All Green  Performance focus
```

## Data Flow Summary

```
Content Creation
↓
Markdown File (.md)
↓
Git Push
↓
GitHub Actions
├─ Read Posts
├─ Generate Graph JSON
├─ Build with Jekyll
├─ Optimize Assets
└─ Deploy to Pages
↓
Static Website
├─ HTML
├─ CSS
├─ JavaScript
├─ Graph Data
└─ Images
↓
Visitor Browser
├─ Downloads from CDN
├─ Renders Page
├─ Loads Images on Demand
├─ Interactive Graph
└─ Search Functionality
```

This architecture is:
- ✅ **Fast** - Static sites are quick
- ✅ **Secure** - No database to hack
- ✅ **Scalable** - Works with 100s of posts
- ✅ **Cheap** - GitHub Pages is free
- ✅ **Reliable** - GitHub's infrastructure
- ✅ **Simple** - Just Markdown files
